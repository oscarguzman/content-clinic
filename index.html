<script>
  const form = document.getElementById('contentForm');
  const responseDiv = document.getElementById('response');

  form.addEventListener('submit', async (e) => {
    e.preventDefault();
    responseDiv.innerText = 'Generating...';

    const data = {
      topic: form.topic.value,
      tone: form.tone.value,
      platform: form.platform.value
    };

    try {
      const res = await fetch('https://api.allorigins.win/raw?url=https://hook.us2.make.com/72gm5ddedrrduotjw4to8qrwcx2hnwtf', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify(data)
      });

      const result = await res.json();

      if (result.result) {
        responseDiv.innerText = decodeURIComponent(result.result);
      } else {
        responseDiv.innerText = 'Something went wrong. No result returned.';
      }
    } catch (err) {
      console.error(err);
      responseDiv.innerText = 'An error occurred. Please try again.';
    }
  });
</script>
